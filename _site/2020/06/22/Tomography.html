<!DOCTYPE html>
<html>

  <head>
  
    





  

  <meta charset="utf-8">  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/n-blog/assets/images/favicon.ico" type="image/png" />    
  <title>Quantum State Tomography</title>
  
  <meta name="description" content="1) Introduction">
  <link rel="stylesheet" href="/n-blog/css/main.css">
  <link rel="canonical" href="http://localhost:4000/n-blog/2020/06/22/Tomography.html">
  <link rel="alternate" type="application/rss+xml" title="N-Blog" href="http://localhost:4000/n-blog/feed.xml">

  <!-- For Latex -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    <a class="site-title" href="/n-blog/">N-Blog</a>

    
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <nav class="site-nav">
        <a class="page-link" href="/n-blog/about/">&#x1f4ee; About</a>
      </nav>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Quantum State Tomography</h1>
    <p class="post-meta"><time datetime="2020-06-22T05:00:00-03:00" itemprop="datePublished">Jun 22, 2020</time></p>
    <span>[
      
        
        <a href="/n-blog/tag/Quantum-Computing"><code class="highligher-rouge"><nobr>Quantum-Computing</nobr></code>&nbsp;</a>
      
        
        <a href="/n-blog/tag/Qiskit"><code class="highligher-rouge"><nobr>Qiskit</nobr></code>&nbsp;</a>
      
    ]</span>
    
  </header>
  
  <div class="post-content" itemprop="articleBody">
    <h1 id="1-introduction">1) Introduction</h1>

<p>Let’s try to do the tomography of a given one-qubit quantum state just to understand the principle behind this procedure:</p>

<script type="math/tex; mode=display">% <![CDATA[
\rho = \begin{pmatrix}
                \rho_{11} & \rho_{12} \\
                \rho_{21} & \rho_{22}
           \end{pmatrix} =  \frac{1}{2} \sum_{i=0}^3 S_i \sigma_i %]]></script>

<p>Where  <script type="math/tex">\rho_{11} + \rho_{22} = 1</script>, <script type="math/tex">\rho_{12} = \rho_{21}^*</script>, and <script type="math/tex">\sigma_i</script> are the pauli matrices.</p>

<script type="math/tex; mode=display">% <![CDATA[
\sigma_0 = I \ \ \ \sigma_1 = \sigma_x = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix} \ \ \ \sigma_2 = \sigma_y = \begin{pmatrix} 0 & i \\ -i & 0 \end{pmatrix} \ \ \ \sigma_3 = \sigma_z = \begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix} %]]></script>

<p>Our goal is to find <script type="math/tex">S_i</script> an then characterize the state.</p>

<p>A problem is that the IBM quantum computers only measures on the Z axis, therefore we only can know $S_3$ that is associated as the expected value of the measurement along the Z axis. 
We need to do a trick to be able to measure <script type="math/tex">% <![CDATA[
\big<X\big> %]]></script> and <script type="math/tex">% <![CDATA[
\big<Y\big> %]]></script>.</p>

<p>Let’s first check what are the eigenvectors of those operators.</p>

<ul>
  <li>
    <p>X has as eigenvectors 
<script type="math/tex">\left| + \right> = \frac{1}{\sqrt{2}} \bigg( \left| 0 \right> + \left| 1 \right> \bigg)</script> 
and 
<script type="math/tex">\left| - \right> = \frac{1}{\sqrt{2}} \bigg( \left| 0 \right> - \left| 1 \right> \bigg)</script> ;</p>
  </li>
  <li>
    <p>Y has as eigenvectors 
<script type="math/tex">\left| i^+ \right> = \frac{1}{\sqrt{2}} \bigg( \left| 0 \right> + i\left| 1 \right> \bigg)</script> 
and 
<script type="math/tex">\left| i^- \right> = \frac{1}{\sqrt{2}} \bigg( \left| 0 \right> - i\left| 1 \right> \bigg)</script> ;</p>
  </li>
</ul>

<p>Thus to measure on those bases we need only to add a way to generate those eigenvectors on the circuit:</p>

<ul>
  <li>To generate X, we only need to apply the gate $H$.</li>
  <li>To generate Y, we need to apply the gate 
<script type="math/tex">S^{\dagger}H</script>.</li>
</ul>

<h1 id="2-doing-quantum-state-tomography-by-hand-on-qiskit">2) Doing Quantum State Tomography by hand on qiskit</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">qiskit</span> <span class="k">as</span> <span class="n">qsk</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<p>In order to test this, consider we have the state 
<script type="math/tex">\left| \psi \right> = \frac{1}{\sqrt{2}} \big( \left| 0 \right> + \left| 1 \right> \big)</script> 
and we want to do the tomography of this state.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">measure_X</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>    
    <span class="n">circuit</span><span class="p">.</span><span class="n">barrier</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">circuit</span><span class="p">.</span><span class="n">h</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">circuit</span><span class="p">.</span><span class="n">measure</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">circuit</span>

<span class="k">def</span> <span class="nf">measure_Y</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>    
    <span class="n">circuit</span><span class="p">.</span><span class="n">barrier</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">circuit</span><span class="p">.</span><span class="n">sdg</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">circuit</span><span class="p">.</span><span class="n">h</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>    
    <span class="n">circuit</span><span class="p">.</span><span class="n">measure</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">circuit</span>

<span class="k">def</span> <span class="nf">tomography</span><span class="p">(</span><span class="n">circuit</span><span class="p">):</span>
    <span class="s">""" Tomography of a one qubit Circuit.
    """</span>
    <span class="n">qc_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base</span> <span class="o">=</span> <span class="p">[</span><span class="s">'X'</span><span class="p">,</span> <span class="s">'Y'</span><span class="p">,</span> <span class="s">'Z'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">base</span><span class="p">:</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Q</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s">'X'</span><span class="p">:</span>
            <span class="n">measure_X</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">qc_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s">'Y'</span><span class="p">:</span>
            <span class="n">measure_Y</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span>  <span class="mi">0</span><span class="p">)</span>
            <span class="n">qc_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s">'Z'</span><span class="p">:</span>
            <span class="n">Q</span><span class="p">.</span><span class="n">measure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">qc_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">qc_list</span><span class="p">,</span> <span class="n">base</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qc</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="p">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qcs</span><span class="p">,</span> <span class="n">bases</span> <span class="o">=</span> <span class="n">tomography</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
</code></pre></div></div>

<p>Running tomography</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">backend_sim</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">Aer</span><span class="p">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s">'qasm_simulator'</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">qcs</span><span class="p">,</span> <span class="n">backend_sim</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">job</span><span class="p">.</span><span class="n">result</span><span class="p">()</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">circuit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qcs</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">circuit</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">f'Base measured </span><span class="si">{</span><span class="n">bases</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'0': 5000}
Base measured X

{'0': 2484, '1': 2516}
Base measured Y

{'0': 2503, '1': 2497}
Base measured Z
</code></pre></div></div>

<p>Thus we have: X = 1, Y = 0 and Z = 0, because 0 is equivalent to +1 and 1 equivalent to -1. It is not exactly 0 because of statistical fluctiations.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_density_matrix</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span><span class="n">circuits</span><span class="p">):</span>
    <span class="s">"""Get density matrix from tomography measurements.

    """</span>
    <span class="n">density_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">complex128</span><span class="p">)</span>
    <span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">1j</span><span class="p">],[</span><span class="mf">1j</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">sigma_z</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="p">[</span><span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">sigma_z</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">circuits</span><span class="p">)):</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">measurements</span><span class="p">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s">'0'</span> <span class="ow">in</span> <span class="n">R</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s">'1'</span> <span class="ow">in</span> <span class="n">R</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">zero</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="s">'0'</span><span class="p">]</span>
            <span class="n">one</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="s">'1'</span><span class="p">]</span>
        
        <span class="k">elif</span> <span class="s">'1'</span> <span class="ow">in</span> <span class="n">R</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">one</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="s">'1'</span><span class="p">]</span>
        
        <span class="k">elif</span> <span class="s">'0'</span> <span class="ow">in</span> <span class="n">R</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">zero</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="s">'0'</span><span class="p">]</span>
            <span class="n">one</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">(</span><span class="n">zero</span> <span class="o">-</span> <span class="n">one</span><span class="p">)</span><span class="o">/</span><span class="n">total</span>        
        <span class="n">density_matrix</span> <span class="o">+=</span> <span class="n">expected</span> <span class="o">*</span> <span class="n">basis</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">density_matrix</span>

<span class="n">density</span> <span class="o">=</span> <span class="n">get_density_matrix</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">qcs</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">density</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[0.5006+0.j     0.5   +0.0032j]
 [0.5   -0.0032j 0.4994+0.j    ]]
</code></pre></div></div>

<p>Writing the density matrix:
<script type="math/tex">% <![CDATA[
\rho = \frac{1}{2} \begin{pmatrix} 
            1 & 1 \\
            1 & 1
           \end{pmatrix} %]]></script></p>

<h1 id="3-doing-quantum-state-tomography-using-ignis">3) Doing Quantum State Tomography using Ignis</h1>

<p>Qiskit has a module inside ignis to do <a href="https://qiskit-staging.mybluemix.net/documentation/ignis/tomography.html">tomography</a> that does exactly what we’ve done before, but is generalized for multiple qubits as input.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">state_tomography_circuits</span>

<span class="n">tomography_circuits</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">meas_labels</span><span class="o">=</span><span class="s">'Pauli'</span><span class="p">,</span> <span class="n">meas_basis</span><span class="o">=</span><span class="s">'Pauli'</span><span class="p">)</span>
</code></pre></div></div>

<p>As a check, let’s see how they measure the Y basis, and we can verify that it is the same way as we did before.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tomography_circuits</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">draw</span><span class="p">(</span><span class="s">'mpl'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/n-blog/assets/2020-06-22-Tomography_files/2020-06-22-Tomography_14_0.svg" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">backend_sim</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">Aer</span><span class="p">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s">'qasm_simulator'</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">tomography_circuits</span><span class="p">,</span> <span class="n">backend_sim</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">job</span><span class="p">.</span><span class="n">result</span><span class="p">()</span>
</code></pre></div></div>

<p>They also has a function to transform the results to a density matrix which treats the state tomography as an optimization problem. The <code class="highlighter-rouge">fit</code> method has several methods for fitting the tomography results, such as <code class="highlighter-rouge">cvx</code> which is convex optimization and <code class="highlighter-rouge">lstsq</code> which makes uses the least square optimization.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">StateTomographyFitter</span>

<span class="n">state_fitter</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">tomography_circuits</span><span class="p">,</span> <span class="n">meas_basis</span><span class="o">=</span><span class="s">'Pauli'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">density_matrix</span> <span class="o">=</span> <span class="n">state_fitter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'lstsq'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">density_matrix</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[0.49040221+0.j         0.49988484+0.00479889j]
 [0.49988484-0.00479889j 0.50959779+0.j        ]]
</code></pre></div></div>

<p>Which is approximately what we expect, as shown before.</p>

<h1 id="4-state-tomography-of-3-qubits">4) State tomography of 3 qubits</h1>

<p>For this example, let’s use the GHZ state:</p>

<script type="math/tex; mode=display">\left| \psi \right> = \frac{1}{\sqrt{2}} \bigg( \left| 000 \right> + \left| 111 \right> \bigg)</script>

<p>This state is simply constructed using an H gate and two CNOT gates:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qc</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qc</span><span class="p">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="p">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="p">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qc</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="s">'mpl'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/n-blog/assets/2020-06-22-Tomography_files/2020-06-22-Tomography_22_0.svg" /></p>

<p>In order to indicate which qubits we want to do tomography, we need to put an list after choosing the circuit that we want to do tomography. In this case, we want to do tomography of all qubits of qc, therefore we need to put <code class="highlighter-rouge">[0,1,2]</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">state_tomography_circuits</span>

<span class="n">tomography_circuits</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> 
                                                <span class="n">meas_labels</span><span class="o">=</span><span class="s">'Pauli'</span><span class="p">,</span> 
                                                <span class="n">meas_basis</span><span class="o">=</span><span class="s">'Pauli'</span><span class="p">)</span>
<span class="n">backend_sim</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">Aer</span><span class="p">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s">'qasm_simulator'</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">qsk</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">tomography_circuits</span><span class="p">,</span> <span class="n">backend_sim</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">job</span><span class="p">.</span><span class="n">result</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">StateTomographyFitter</span>

<span class="n">state_fitter</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">tomography_circuits</span><span class="p">,</span> <span class="n">meas_basis</span><span class="o">=</span><span class="s">'Pauli'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">density_matrix</span> <span class="o">=</span> <span class="n">state_fitter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'lstsq'</span><span class="p">)</span>
</code></pre></div></div>

<p>Let’s define a helper function that plots the real and imaginary part as a grey scale image:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_density_matrix</span><span class="p">(</span><span class="n">DM</span><span class="p">):</span>
    <span class="s">"""Helper function to plot density matrices.

    Parameters
    ----------------------------------------------
    DM(np.array): Density Matrix.
    
    """</span>
    <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MaxNLocator</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">real</span><span class="p">(</span><span class="n">DM</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'Greys'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">ax1</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Real Part'</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">imag</span><span class="p">(</span><span class="n">DM</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'Greys'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">ax2</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Imaginary Part'</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>Ploting the density matrix, we see that there are states only on the first and last column (row), each column (row) represents a quantum state on the computational basis, for this case the states represented are
<script type="math/tex">\left| 000 \right></script> and 
<script type="math/tex">\left| 111 \right></script> respectively. We can ignore the imaginary part, since is is only random noise.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot_density_matrix</span><span class="p">(</span><span class="n">density_matrix</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/n-blog/assets/2020-06-22-Tomography_files/2020-06-22-Tomography_26_0.svg" /></p>

<p>The code for this post is on <a href="https://github.com/nahumsa/Introduction-to-IBM_Qiskit/blob/master/Notebooks/Tomography.ipynb" target="_blank">github</a>.</p>

<h1 id="references">References</h1>

<p>1 - <a href="http://research.physics.illinois.edu/QI/Photonics/tomography-files/tomo_chapter_2004.pdf">Altepeter et al - Quantum State Tomography</a></p>

<p>2 - <a href="https://qiskit.org/documentation/apidoc/verification.html#tomography">Qiskit Ignis Documentation</a></p>

<hr />

<h3>Version Information</h3>
<table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.19.1</td></tr><tr><td>Terra</td><td>0.14.1</td></tr><tr><td>Aer</td><td>0.5.1</td></tr><tr><td>Ignis</td><td>0.3.0</td></tr><tr><td>Aqua</td><td>0.7.0</td></tr><tr><td>IBM Q Provider</td><td>0.7.0</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.7.3 | packaged by conda-forge | (default, Jul  1 2019, 21:52:21) 
[GCC 7.3.0]</td></tr><tr><td>OS</td><td>Linux</td></tr><tr><td>CPUs</td><td>2</td></tr><tr><td>Memory (Gb)</td><td>7.664028167724609</td></tr><tr><td colspan="2">Sat May 23 17:14:48 2020 -03</td></tr></table>


  </div>

</article>

      </div>
    </div>    

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">N-Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>N-Blog</li>
          <li><a href="mailto:nahumsa@cbpf.br">nahumsa@cbpf.br</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/nahumsa"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">nahumsa</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/sa_nahum"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">sa_nahum</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Here I will share thoughts and ideas about Machine Learning  and Quantum Computing.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
