<!doctype html><html prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Creating a Continous Integration pipeline using Github Actions</title><meta name=description content="Setting up CI in github"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=generator content="Hugo 0.83.1"><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Creating a Continous Integration pipeline using Github Actions"><meta property="og:description" content="Setting up CI in github"><meta property="og:type" content="article"><meta property="og:url" content="https://nahumsa.github.io/n-blog/2021-01-21-ci-github-actions/"><link rel=stylesheet href=https://nahumsa.github.io/n-blog/dist/site.css><link rel=stylesheet href=https://nahumsa.github.io/n-blog/dist/syntax.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel="shortcut icon" type=image/jpg href=https://nahumsa.github.io/n-blog/favicon.ico><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}},window.addEventListener('load',a=>{document.querySelectorAll("mjx-container").forEach(function(a){a.parentElement.classList+='has-jax'})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-170504520-1','auto'),ga('send','pageview'))</script><div id=wrapper><header class=site-header><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=https://nahumsa.github.io/n-blog/>n-blog</a></h1><a class="button-square button-social hint--top" data-hint=Twitter aria-label=Twitter href=https://twitter.com/sa_nahum rel=me><i class="fa fa-twitter" aria-hidden=true></i></a>
<a class="button-square button-social hint--top" data-hint=Github aria-label=Github href=https://github.com/nahumsa rel=me><i class="fa fa-github-alt" aria-hidden=true></i></a>
<a class="button-square button-social hint--top" data-hint=Email aria-label="Send an Email" href=mailto:nahumsa@cbpf.br><i class="fa fa-envelope" aria-hidden=true></i></a></div><ul class=site-nav></ul></div></header><div id=container><div class=container><article class=post-container itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">Creating a Continous Integration pipeline using Github Actions</h1><p class=post-description itemprop=description>Setting up CI in github</p><p class="post-date post-line"><span>Published <time datetime=2021-01-21 itemprop=datePublished>Thu, Jan 21, 2021</time></span>
<span>by</span>
<span itemscope itemprop=author itemtype=https://schema.org/Person><span itemprop=name><a href=# itemprop=url rel=author>Nahum SÃ¡</a></span></span></p></header><div class="post-content clearfix" itemprop=articleBody><h1 id=1-introduction>1) Introduction</h1><p>Continous Integration (CI) is the practice of automation the integration of code changes into a single software project. This is a good practive because when the code changes, it builds the application and runs tests to see if the changes in the code doesn&rsquo;t break anything. This method of development is linked directly with Continous Deployment (CD) which is a an automation of deployment of your application</p><p>Besides being a good thing to have all changes in the code being verified if it breaks something in the code, this is a key feature for agile development because the development process becomes more transparent, mainly if the team is using a Test-Driven Development approach.</p><p>There are various tools for CI, for instance Jenkins, CircleCI, github workflows, etc. In this article I will focus on building a CI tool for a python github repository.</p><h1 id=2-creating-the-github-workflow>2) Creating the Github workflow</h1><p>In order to create the githu workflow we need to create a YAML file into a folder on the path &lsquo;.github/workflows&rsquo;, and below is an example of this file which builds and test a github repository on every push. If you want to read the YAML file without comments, check this <a href=https://gist.github.com/nahumsa/feb22436d1beb82c7dbf22cbb63f14fe>link</a>.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#09f;font-style:italic># Define the name that you want your build to have, this is good </span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># because you can read it on the workflow part of github</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#309;font-weight:700>name</span>:<span style=color:#bbb> </span>CI on [Python 3.6, 3.7, 3.8]<span style=color:#bbb>
</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># Choose when you want to activate your workflow,</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># it has a lot of options, for instance using the following strings or </span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># array will trigger in the following command:</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># - pull_request: will run the workflow anytime a pull request occurs;</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># - push: will run the workflow anytime a push occurs on any branch;</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># - realease: will run the workflow when you a release occurs;</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic>#</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># If you want to have various triggers you can use the list syntax:</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># on: [push, pull_request]</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#309;font-weight:700>on</span>:<span style=color:#bbb> </span>push<span style=color:#bbb>
</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># Jobs are what runs on the workflow, if you have more than one job</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># they will run in parallel by default, but you can use a sequential </span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#09f;font-style:italic># run using the needs keyphrase inside the job.</span><span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#309;font-weight:700>jobs</span>:<span style=color:#bbb> 
</span><span style=color:#bbb>  
</span><span style=color:#bbb>  </span><span style=color:#09f;font-style:italic># This is the name of the job that we are running</span><span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#309;font-weight:700>build</span>:<span style=color:#bbb> 
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># We need to choose the type of the machine that we are running the job.</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># There are three types of runner types supported by github: Windows, </span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># Ubuntu, and macOS.</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#309;font-weight:700>runs-on</span>:<span style=color:#bbb> </span>ubuntu-latest<span style=color:#bbb>
</span><span style=color:#bbb>    
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># strategy creates a matrix for your jobs that you can create different </span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># parameter for each run.</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#309;font-weight:700>strategy</span>:<span style=color:#bbb> 
</span><span style=color:#bbb>      
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># using matrix you can create different job configurations using a key</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># valued pairs. </span><span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># Here we will change the python version on each run.</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#309;font-weight:700>matrix</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#309;font-weight:700>python-version</span>:<span style=color:#bbb> </span>[<span style=color:#f60>3.6</span>,<span style=color:#bbb> </span><span style=color:#f60>3.7</span>,<span style=color:#bbb> </span><span style=color:#f60>3.8</span>]<span style=color:#bbb>
</span><span style=color:#bbb>    
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># This is what the job will in fact run so each step you can add a name</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># and environment variables, it is important to note that each step </span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># runs its own process in the runner environment and has access to the </span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># workspace and filesystem, because of that environment variables on each </span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#09f;font-style:italic># run will not be shared.</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#309;font-weight:700>steps</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># Here we setup the action trigger on checkout</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span>- <span style=color:#309;font-weight:700>uses</span>:<span style=color:#bbb> </span>actions/checkout@v2<span style=color:#bbb>
</span><span style=color:#bbb>      
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># Here we setup python for our build using the matrix values to</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># run in different python versions</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span>- <span style=color:#309;font-weight:700>name</span>:<span style=color:#bbb> </span>Build using Python ${{ matrix.python-version }}<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#309;font-weight:700>uses</span>:<span style=color:#bbb> </span>actions/setup-python@v2<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#309;font-weight:700>with</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#309;font-weight:700>python-version</span>:<span style=color:#bbb> </span>${{ matrix.python-version }}<span style=color:#bbb>
</span><span style=color:#bbb>      
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># Here we install all dependencies using a requirements.txt file</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span>- <span style=color:#309;font-weight:700>name</span>:<span style=color:#bbb> </span>Installing dependencies<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#309;font-weight:700>run</span>:<span style=color:#bbb> </span>|<span style=color:#c30;font-style:italic>
</span><span style=color:#c30;font-style:italic>          python -m pip install pip --upgrade pip
</span><span style=color:#c30;font-style:italic>          pip install -r requirements.txt</span><span style=color:#bbb>          
</span><span style=color:#bbb>      
</span><span style=color:#bbb>      </span><span style=color:#09f;font-style:italic># Here we change our folder using &#39;cd&#39; and run all unittests on that folder</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span>- <span style=color:#309;font-weight:700>name</span>:<span style=color:#bbb> </span>Running tests<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#309;font-weight:700>run</span>:<span style=color:#bbb> </span>|<span style=color:#c30;font-style:italic>
</span><span style=color:#c30;font-style:italic>          cd tests/
</span><span style=color:#c30;font-style:italic>          python -m unittest</span><span style=color:#bbb>          
</span><span style=color:#bbb>
</span></code></pre></div><p>You can learn more about the syntax on the <a href=https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions>github docs</a>.</p><h1 id=references>References</h1><ul><li><a href=https://docs.github.com/en/actions/reference/events-that-trigger-workflows>Trigger workflows documentation</a></li><li><a href=https://www.atlassian.com/continuous-delivery/continuous-integration>Atlassian</a></li></ul></div><footer class="post-footer clearfix"><div class=share><a class=icon-twitter href="https://twitter.com/share?text=Creating%20a%20Continous%20Integration%20pipeline%20using%20Github%20Actions&url=https%3a%2f%2fnahumsa.github.io%2fn-blog%2f2021-01-21-ci-github-actions%2f" onclick="return window.open(this.href,'twitter-share','width=550,height=235'),!1" aria-label="Share on Twitter"><i class="fa fa-twitter" aria-hidden=true></i></a></div></footer></article></div></div></div><footer class=footer><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=https://nahumsa.github.io/n-blog/>n-blog</a></h1><a class="button-square button-jump-top js-jump-top" href=# aria-label="Back to Top"><i class="fa fa-angle-up" aria-hidden=true></i></a></div><p class=footer-copyright><span>&copy; 2021 / Powered by <a href=https://gohugo.io/>Hugo</a></span></p><p class=footer-copyright><span><a href=https://github.com/roryg/ghostwriter>Ghostwriter theme</a> By <a href=http://jollygoodthemes.com>JollyGoodThemes</a></span>
<span>/ <a href=https://github.com/jbub/ghostwriter>Ported</a> to Hugo By <a href=https://github.com/jbub>jbub</a></span></p></div></footer><script src=https://nahumsa.github.io/n-blog/js/jquery-1.11.3.min.js></script><script src=https://nahumsa.github.io/n-blog/js/jquery.fitvids.js></script><script src=https://nahumsa.github.io/n-blog/js/scripts.js></script></body></html>